\subsection{Slow-time curve parameters, state vectors and the geoid model}
\label{sc:svgeoid}
\Scref{sc:arcslow} produced expressions that depend upon $\satt(t)$, $\dx(t)$, $\ddx(t)$ and $\dddx(t)$. This section demonstrates how these quantities can be computed from state vectors and the NASA published geoid model (EGM96 or EGM2008), \cite{NASAEGM86}.
\subsubsection{State vectors}
State vectors provided by vendors often reference the ECEF coordinate system; that is, they are given in an Earth-Centred, Earth Fixed (ECEF) coordinate system. We define the position component of the state vector as $\satt(t)$ while the velocity component provides $\dx(t)$.
\subsubsection{Geopotential model}
Calculation of $\ddx(t)$ and $\dddx(t)$ requires application of a geoid model as the acceleration at any given point depends primarily on the mass distribution of the earth. Secondary factors including drag, lunar and solar gravitation effects and tidal effects are not considered here. It is felt that these effects do not significantly perturb the satellite trajectory over the time periods of even the highest resolution synthetic apertures. 
\par
The EGM96 geopotential model provides a set of parameters to be used in a spherical harmonic expansion that approximates the earth gravitational potential, \cite{NASAEGM86}. The prescription yields the graviational potential as a function of radius, latitude, longitude, respectively, $U(r, \lat, \lng)$. 
\begin{equation}
\begin{split}
 &U(r, \lat, \lng)\\ &= \frac{GM}{r}\biggl(1+\sum_{n=2}^{n_{\text{max}}}\left(\frac{a}{r}\right)^n\sum_{m=0}^n\bar{P}_{nm}(\sin\lat)\left[\bar{C}_{nm}\cos{m\lng} + \bar{S}_{nm}\sin{m\lng}\right]\biggr)
\end{split}
\label{eq:egm96model}
\end{equation}
where $a$ is the major axis of the Earth (m), $\bar{P}_{nm}(\cdot)$ are the fully normalized associated Legendre polynomials of degree $n$ and order $m$, $\bar{C}_{nm}$ and $\bar{S}_{nm}$ are the model coefficients (e.g. egm96, egm2008 from NIMA/NGA). 
Note that $\lat$, $\lng$ are given in a spherical polar coordinates not the common ellipsoidal latitude and longitude as in geography. 
\par
The gravitational potential and its derivatives, given in spherical polar coordinates, are transformed into Cartesian coordinates in order to calculate the acceleration and rate of change of acceleration. \Anref{an:rateacc} outlines how this can be accomplished. A clearly written explanation on how to apply the spehircal harmonics to calculation of satellite trajectories can be found in \cite{Shou2014}. This document calculates the satellite acceleration in the ECEF coordinate system; further, the material in \anref{an:rateacc} also considers the rate of change of acceleration as this becomes important in the derivation of the satellite motion over long synthetic apertures.
\par
Note that the gravitational potential is given in an inertial coordinate system. Thus, calculated accelerations must be transformed into an ECEF coordinate system. \Anref{an:inertialecef} and \cite{Shou2014} show how this transformation can be accomplished. 
\par
\Fgref{fg:GeoidPreciseState} demonstrates the accuracy of the physical geoid model using precision state vector data obtained from \cite{SentinelPOD}. The plot has been generated by taking a single state vector at slow-time value zero (arbitrarily chosen to be 2018-08-05 16:08:22) and numerically integrating the position of the satellite forty seconds forwards and backwards in time. This numerical result has been computed by using the scipy {\em integrate.solve\_ivp} method in Python3 to integrate the differential equation listed in \cite{Shou2014}; in this case with the egm96 geoid model, but without any lunar solar or drag effects. Either side of slow-time zero, the recoded precise state vectors are compared with the numerically integrated result. One sees that, over the course of eighty seconds, the satellite position is within 5 millimeters of the reference position.
\begin{figure}
    \resizebox{\textwidth}{!}{\input{numericalDiffIntegationError.pgf}}
	\caption{Comparison of numerical integration of the differential equation of satellite motion with recorded precise state vectors sourced from \cite{SentinelPOD}}
	\label{fg:GeoidPreciseState}
\end{figure}
